{% extends "base.html" %}
{% load static %}

{% block content %}
    <h1>Add news</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <p class="slug-preview">Slug: <span id="slug-display"></span></p>
        <button type="submit">Save</button>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const titleInput = document.querySelector('.title-input');
            const slugInput = document.querySelector('input[name="slug"]');
            const slugDisplay = document.querySelector('#slug-display');

            function generateSlug(text) {
                return text.toString().toLowerCase()
                    .replace(/\s+/g, '-')           // Replace spaces with -
                    .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
                    .replace(/\-\-+/g, '-')         // Replace multiple - with single -
                    .replace(/^-+/, '')             // Trim - from start of text
                    .replace(/-+$/, '');            // Trim - from end of text
            }

            titleInput.addEventListener('input', function(e) {
                const slug = generateSlug(e.target.value);
                slugInput.value = slug;
                slugDisplay.textContent = slug;
            });
        });
    </script>

    <style>
        .slug-preview {
            color: #666;
            font-style: italic;
            margin-top: -10px;
            margin-bottom: 10px;
        }
    </style>
{% endblock %}